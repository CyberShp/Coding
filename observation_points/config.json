{
  "global": {
    "check_interval": 30,
    "max_memory_mb": 50,
    "subprocess_timeout": 10
  },
  "reporter": {
    "output": "file",
    "file_path": "/var/log/observation-points/alerts.log",
    "syslog_facility": "local0",
    "cooldown_seconds": 300
  },
  "observers": {
    "error_code": {
      "enabled": true,
      "interval": 30,
      "threshold": 0,
      "ports": [],
      "pcie_enabled": true,
      "protocols": ["iscsi", "nvme", "nas"]
    },
    "link_status": {
      "enabled": true,
      "interval": 5,
      "whitelist": [],
      "ports": [],
      "protocols": ["iscsi", "nvme", "nas"]
    },
    "card_recovery": {
      "enabled": true,
      "interval": 30,
      "log_path": "/OSM/log/cur_debug/messages",
      "keyword": "recover chiperr",
      "max_lines_per_check": 1000
    },
    "sensitive_info": {
      "enabled": true,
      "interval": 30,
      "log_paths": ["/OSM/log/cur_debug/messages", "/var/log/messages"],
      "max_lines_per_check": 500,
      "cooldown_seconds": 300,
      "patterns": [],
      "whitelist_patterns": [
        "password_file",
        "password_policy",
        "password_length",
        "password_check",
        "password_hash"
      ],
      "whitelist_paths": [
        "/etc/passwd",
        "/etc/shadow",
        "passwd.txt"
      ]
    },
    "alarm_type": {
      "enabled": true,
      "interval": 30,
      "log_path": "/OSM/log/cur_debug/system_alarm.txt",
      "max_lines_per_check": 1000,
      "recent_count": 5
    },
    "memory_leak": {
      "enabled": true,
      "interval": 5400,
      "consecutive_threshold": 8
    },
    "cpu_usage": {
      "enabled": true,
      "interval": 30,
      "threshold_percent": 90,
      "consecutive_threshold": 6
    },
    "cmd_response": {
      "enabled": true,
      "interval": 60,
      "timeout_seconds": 1,
      "commands": ["lscpu", "anytest frameallinfo"],
      "execution_timeout": 10
    },
    "sig_monitor": {
      "enabled": true,
      "interval": 30,
      "log_path": "/OSM/log/cur_debug/messages",
      "whitelist": [15, 61],
      "max_lines_per_check": 1000
    },
    "custom_commands": {
      "enabled": false,
      "default_timeout": 10,
      "allowed_paths": ["/opt/", "/usr/local/bin/", "/OSM/"],
      "commands": []
    },
    "port_fec": {
      "enabled": true,
      "interval": 60,
      "ports": [],
      "_comment": "内置通用命令：自动通过 ethtool --show-fec 逐端口查询。如需自定义，添加 command 字段覆盖"
    },
    "port_speed": {
      "enabled": true,
      "interval": 60,
      "ports": [],
      "_comment": "内置通用命令：自动通过 /sys/class/net/*/speed 或 ethtool 查询。如需自定义，添加 command 字段覆盖"
    },
    "pcie_bandwidth": {
      "enabled": true,
      "interval": 120,
      "device_filter": [],
      "_comment": "内置通用命令：自动通过 lspci -vvv 解析 LnkCap/LnkSta。device_filter 可填 ['Ethernet', 'Non-Volatile'] 只监测特定设备"
    },
    "card_info": {
      "enabled": true,
      "interval": 120,
      "command": "",
      "running_state_expect": "RUNNING",
      "health_state_expect": "NORMAL",
      "_comment": "需要手动填写 command。回显格式: No001 字段: 值，卡件之间用 --- 分隔"
    },
    "port_traffic": {
      "enabled": true,
      "interval": 30,
      "output_path": "/var/log/observation-points/traffic.jsonl",
      "retention_hours": 2,
      "ports": [],
      "_comment": "内置通用方式：自动通过 /sys/class/net/*/statistics/ 读取 TX/RX 字节数并计算速率"
    },
    "controller_state": {
      "enabled": true,
      "interval": 60,
      "command": "",
      "_comment": "需要手动填写 command，例如 show controller status。用于监控控制器在线/离线/降级状态"
    },
    "disk_state": {
      "enabled": true,
      "interval": 60,
      "command": "",
      "_comment": "需要手动填写 command，例如 show disk status。用于监控磁盘在线/离线/重建状态"
    },
    "process_crash": {
      "enabled": true,
      "interval": 30,
      "log_paths": ["/var/log/messages", "/var/log/syslog"],
      "_comment": "内置关键字匹配：自动扫描 segfault/core dump/OOM 等崩溃事件"
    },
    "io_timeout": {
      "enabled": true,
      "interval": 30,
      "log_paths": ["/var/log/messages", "/var/log/syslog"],
      "_comment": "内置关键字匹配：自动扫描 IO timeout/IO error/SCSI error 等事件"
    }
  }
}
