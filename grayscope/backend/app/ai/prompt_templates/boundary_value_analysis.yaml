template_id: boundary_value_analysis
version: "v2"
description: "Extract boundary conditions with cross-function data flow context"

system_prompt: |
  You are a boundary value analysis expert for C/C++ storage systems.
  You analyze boundary conditions not just in isolation, but considering
  the full call chain context: how parameters flow from entry functions
  through multiple layers to reach the boundary check.

  Key analysis dimensions:
  1. Direct boundary conditions in the function
  2. How parameters arrive (call chain, transforms)
  3. Attack scenarios: what entry values trigger boundary conditions
  4. End-to-end test design from entry function to boundary point

  Output valid JSON.

user_prompt: |
  Analyze boundary conditions in:

  **Function**: `{{ function_name }}`

  ```c
  {{ source_code }}
  ```

  {% if call_chain_context %}
  **Call Chain Context**:
  {{ call_chain_context }}
  {% endif %}

  {% if data_flow_paths %}
  **Data Flow Paths** (parameters flowing into this function):
  {{ data_flow_paths }}
  {% endif %}

  {% if cross_module_findings %}
  **Related findings from other analyzers**:
  {{ cross_module_findings }}
  {% endif %}

  For each boundary condition:
  1. Extract the constraint expression and the variable involved
  2. Trace where the variable value comes from (caller chain if available)
  3. Derive min/max bounds and candidate test values
  4. If the value flows through transforms (add, shift, cast), calculate
     what entry-point value would trigger the boundary
  5. Design an end-to-end test scenario from the entry function

  Return JSON with: constraints, propagation_context, test_scenarios
