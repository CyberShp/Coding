# å­˜å‚¨é˜µåˆ—è§‚å¯Ÿç‚¹ç›‘æ§ç³»ç»Ÿ â€” ç”¨æˆ·æ‰‹å†Œ

> **ç‰ˆæœ¬**ï¼š2.1.0  
> **é€‚ç”¨äººç¾¤**ï¼šå­˜å‚¨æµ‹è¯•å·¥ç¨‹å¸ˆã€è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°ç»´æŠ¤äººå‘˜  
> **æœ€åæ›´æ–°**ï¼š2026-02-05

---

## ç›®å½•

1. [ç³»ç»Ÿç®€ä»‹](#1-ç³»ç»Ÿç®€ä»‹)
2. [ç³»ç»Ÿæ¶æ„](#2-ç³»ç»Ÿæ¶æ„)
3. [éƒ¨ç½²æŒ‡å—](#3-éƒ¨ç½²æŒ‡å—)
4. [åŠŸèƒ½è¯¦è§£](#4-åŠŸèƒ½è¯¦è§£)
   - 4.1 [ä»ªè¡¨ç›˜](#41-ä»ªè¡¨ç›˜)
   - 4.2 [é˜µåˆ—ç®¡ç†](#42-é˜µåˆ—ç®¡ç†)
   - 4.3 [å‘Šè­¦ä¸­å¿ƒ](#43-å‘Šè­¦ä¸­å¿ƒ)
   - 4.4 [æµ‹è¯•ä»»åŠ¡ç®¡ç†](#44-æµ‹è¯•ä»»åŠ¡ç®¡ç†)
   - 4.5 [äº‹ä»¶æ—¶é—´çº¿](#45-äº‹ä»¶æ—¶é—´çº¿)
   - 4.6 [çŠ¶æ€å¿«ç…§ä¸å¯¹æ¯”](#46-çŠ¶æ€å¿«ç…§ä¸å¯¹æ¯”)
   - 4.7 [ç«¯å£æµé‡ç›‘æ§](#47-ç«¯å£æµé‡ç›‘æ§)
   - 4.8 [æ€§èƒ½ç›‘æ§ï¼ˆCPU / å†…å­˜ï¼‰](#48-æ€§èƒ½ç›‘æ§cpu--å†…å­˜)
   - 4.9 [è‡ªå®šä¹‰æŸ¥è¯¢](#49-è‡ªå®šä¹‰æŸ¥è¯¢)
   - 4.10 [å®šæ—¶ä»»åŠ¡](#410-å®šæ—¶ä»»åŠ¡)
   - 4.11 [æ•°æ®ç®¡ç†ä¸å½’æ¡£](#411-æ•°æ®ç®¡ç†ä¸å½’æ¡£)
   - 4.12 [ç³»ç»Ÿå‘Šè­¦](#412-ç³»ç»Ÿå‘Šè­¦)
   - 4.13 [å…³é”®äº‹ä»¶é€šçŸ¥](#413-å…³é”®äº‹ä»¶é€šçŸ¥)
5. [è§‚å¯Ÿç‚¹ï¼ˆObserverï¼‰å®Œæ•´åˆ—è¡¨](#5-è§‚å¯Ÿç‚¹observerå®Œæ•´åˆ—è¡¨)
   - 5.1 [ç«¯å£çº§è§‚å¯Ÿç‚¹](#51-ç«¯å£çº§è§‚å¯Ÿç‚¹)
   - 5.2 [å¡ä»¶çº§è§‚å¯Ÿç‚¹](#52-å¡ä»¶çº§è§‚å¯Ÿç‚¹)
   - 5.3 [ç³»ç»Ÿçº§è§‚å¯Ÿç‚¹](#53-ç³»ç»Ÿçº§è§‚å¯Ÿç‚¹)
6. [å‘Šè­¦ä½“ç³»](#6-å‘Šè­¦ä½“ç³»)
   - 6.1 [å‘Šè­¦çº§åˆ«](#61-å‘Šè­¦çº§åˆ«)
   - 6.2 [å‘Šè­¦ä¸‰æ®µå¼å¯è¯»æ€§](#62-å‘Šè­¦ä¸‰æ®µå¼å¯è¯»æ€§)
   - 6.3 [å‘Šè­¦èšåˆä¸é£æš´æŠ‘åˆ¶](#63-å‘Šè­¦èšåˆä¸é£æš´æŠ‘åˆ¶)
7. [é…ç½®å‚è€ƒ](#7-é…ç½®å‚è€ƒ)
   - 7.1 [Web ç«¯é…ç½®](#71-web-ç«¯é…ç½®)
   - 7.2 [Agent ç«¯é…ç½®](#72-agent-ç«¯é…ç½®)
8. [è§„æ ¼ä¸çº¦æŸ](#8-è§„æ ¼ä¸çº¦æŸ)
9. [å¸¸è§åœºæ™¯æ“ä½œæŒ‡å—](#9-å¸¸è§åœºæ™¯æ“ä½œæŒ‡å—)
10. [æ•…éšœæ’æŸ¥](#10-æ•…éšœæ’æŸ¥)
11. [æœ¯è¯­è¡¨](#11-æœ¯è¯­è¡¨)

---

## 1. ç³»ç»Ÿç®€ä»‹

**å­˜å‚¨é˜µåˆ—è§‚å¯Ÿç‚¹ç›‘æ§ç³»ç»Ÿ**æ˜¯ä¸€å¥—é¢å‘å­˜å‚¨æµ‹è¯•åœºæ™¯çš„è½»é‡çº§ç›‘æ§å·¥å…·ï¼Œç”±ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼š

| ç»„ä»¶ | è¿è¡Œä½ç½® | èŒè´£ |
|------|---------|------|
| **observation_points**ï¼ˆAgentï¼‰ | å­˜å‚¨é˜µåˆ—ä¸Š | åœ¨é˜µåˆ—æœ¬åœ°è¿è¡Œï¼Œå‘¨æœŸæ€§æ£€æŸ¥å„é¡¹æŒ‡æ ‡ï¼Œè¾“å‡ºå‘Šè­¦æ—¥å¿— |
| **observation_web**ï¼ˆWeb å¹³å°ï¼‰ | æœ¬åœ° PC / æµ‹è¯•æœåŠ¡å™¨ | ç®¡ç†é˜µåˆ—è¿æ¥ã€é‡‡é›†å‘Šè­¦æ•°æ®ã€æä¾› Web å¯è§†åŒ–ç•Œé¢ |

### æ ¸å¿ƒä»·å€¼

- **æµ‹è¯•åœºæ™¯æ„ŸçŸ¥**ï¼šæ”¯æŒåˆ›å»ºæµ‹è¯•ä»»åŠ¡ï¼Œç³»ç»Ÿè‡ªåŠ¨å…³è”å‘Šè­¦ä¸æµ‹è¯•ä¸Šä¸‹æ–‡ï¼ŒåŒºåˆ†"é¢„æœŸå¼‚å¸¸"å’Œ"çœŸæ­£é—®é¢˜"
- **å…³é”®äº‹ä»¶èšç„¦**ï¼šè¿›ç¨‹å´©æºƒã€IO è¶…æ—¶ã€æ§åˆ¶å™¨ç¦»çº¿ç­‰å…³é”®äº‹ä»¶è‡ªåŠ¨é«˜äº®ï¼Œæ¡Œé¢é€šçŸ¥+å£°éŸ³æé†’ï¼Œä¸è¢«æµ·é‡å‘Šè­¦æ·¹æ²¡
- **å‘Šè­¦é£æš´æŠ‘åˆ¶**ï¼šæ‹”çº¿/ä¸‹ç”µç­‰æ“ä½œè§¦å‘çš„å¤§é‡å‘Šè­¦è‡ªåŠ¨èšåˆä¸ºä¸€æ¡æ ¹å› äº‹ä»¶
- **å…¨å±€æ—¶é—´çº¿**ï¼šè·¨è§‚å¯Ÿç‚¹çš„äº‹ä»¶æŒ‰æ—¶é—´è½´å±•ç¤ºï¼Œç›´è§‚çœ‹åˆ°äº‹ä»¶ä¹‹é—´çš„å…ˆåå…³ç³»
- **é›¶å¤–éƒ¨ä¾èµ–**ï¼šAgent ç«¯ä»…ä¾èµ– Python æ ‡å‡†åº“ï¼Œæ— éœ€åœ¨é˜µåˆ—ä¸Šå®‰è£…ä»»ä½•ç¬¬ä¸‰æ–¹åŒ…

---

## 2. ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœ¬åœ° PC / æµ‹è¯•æœåŠ¡å™¨                  â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  å‰ç«¯ (Vue 3)    â”‚â—„â”€â”€â–ºâ”‚    åç«¯ (FastAPI)         â”‚ â”‚
â”‚  â”‚  ç«¯å£: 5173      â”‚    â”‚    ç«¯å£: 9999             â”‚ â”‚
â”‚  â”‚  Element Plus    â”‚    â”‚    SQLite + SSH Pool     â”‚ â”‚
â”‚  â”‚  ECharts å›¾è¡¨    â”‚    â”‚    WebSocket å®æ—¶æ¨é€     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚ SSH              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                          â”‚                   â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
  â”‚ å­˜å‚¨é˜µåˆ— A    â”‚   â”‚  å­˜å‚¨é˜µåˆ— B     â”‚   â”‚  å­˜å‚¨é˜µåˆ— C    â”‚
  â”‚              â”‚   â”‚                â”‚   â”‚               â”‚
  â”‚  Agent       â”‚   â”‚  Agent         â”‚   â”‚  Agent        â”‚
  â”‚  (Python)    â”‚   â”‚  (Python)      â”‚   â”‚  (Python)     â”‚
  â”‚              â”‚   â”‚                â”‚   â”‚               â”‚
  â”‚  alerts.log  â”‚   â”‚  alerts.log    â”‚   â”‚  alerts.log   â”‚
  â”‚  traffic.jsonlâ”‚   â”‚  traffic.jsonl â”‚   â”‚  traffic.jsonlâ”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€šä¿¡æ–¹å¼

- **PC â†’ é˜µåˆ—**ï¼šé€šè¿‡ SSH è¿æ¥ï¼ˆParamiko åº“ï¼‰ï¼Œç”¨äºéƒ¨ç½² Agentã€å¯åŠ¨/åœæ­¢ Agentã€æ‹‰å–æ—¥å¿—å’Œæµé‡æ•°æ®
- **é˜µåˆ— â†’ PC**ï¼ˆå¯é€‰ï¼‰ï¼šAgent å¯é…ç½® HTTP æ¨é€æ¨¡å¼ï¼Œå°†å‘Šè­¦æ•°æ®ä¸»åŠ¨æ¨é€è‡³ Web åç«¯çš„ `/api/ingest` æ¥å£
- **å‰ç«¯ â†” åç«¯**ï¼šHTTP REST API + WebSocket å®æ—¶å‘Šè­¦æ¨é€

### æ•°æ®å­˜å‚¨

- **é˜µåˆ—ç«¯**ï¼š`alerts.log`ï¼ˆJSON æ ¼å¼å‘Šè­¦æ—¥å¿—ï¼‰ã€`traffic.jsonl`ï¼ˆç«¯å£æµé‡é‡‡é›†æ•°æ®ï¼‰
- **PC ç«¯**ï¼šSQLite æ•°æ®åº“ï¼ˆ`observation_web.db`ï¼‰ï¼Œå­˜å‚¨é˜µåˆ—ä¿¡æ¯ã€å‘Šè­¦è®°å½•ã€å®šæ—¶ä»»åŠ¡ã€å¿«ç…§ç­‰

---

## 3. éƒ¨ç½²æŒ‡å—

### 3.1 ç¯å¢ƒè¦æ±‚

#### æœ¬åœ° PCï¼ˆWeb å¹³å°ï¼‰

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| æ“ä½œç³»ç»Ÿ | Windows / macOS / Linux å‡å¯ |
| Python | 3.8 åŠä»¥ä¸Š |
| Node.js | 16 åŠä»¥ä¸Šï¼ˆç”¨äºå‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼›ç”Ÿäº§æ¨¡å¼å¯é€‰ï¼‰ |
| ç½‘ç»œ | èƒ½é€šè¿‡ SSHï¼ˆé»˜è®¤ 22 ç«¯å£ï¼‰è¿æ¥åˆ°æ‰€æœ‰è¢«ç›‘æ§é˜µåˆ— |
| ç£ç›˜ç©ºé—´ | çº¦ 200 MBï¼ˆå«ä¾èµ–ï¼‰ |

#### å­˜å‚¨é˜µåˆ—ï¼ˆAgentï¼‰

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| æ“ä½œç³»ç»Ÿ | Euler ARM / CentOS / é€šç”¨ Linux |
| Python | 3.6 åŠä»¥ä¸Šï¼ˆä»…æ ‡å‡†åº“ï¼Œæ— éœ€ pipï¼‰ |
| æƒé™ | éœ€è¦ root æƒé™æˆ–å¯è¯» `/sys`ã€`/proc`ã€æ—¥å¿—æ–‡ä»¶çš„ç”¨æˆ· |
| ç£ç›˜ç©ºé—´ | çº¦ 5 MBï¼ˆAgent ä»£ç ï¼‰+ æ—¥å¿—ç©ºé—´ |

### 3.2 é˜µåˆ—ç«¯éƒ¨ç½²ï¼ˆAgentï¼‰

Agent å¯é€šè¿‡ä¸¤ç§æ–¹å¼éƒ¨ç½²ï¼š

#### æ–¹å¼ä¸€ï¼šé€šè¿‡ Web ç•Œé¢ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. åœ¨ Web å¹³å°æ·»åŠ é˜µåˆ—ï¼Œå¡«å†™ IPã€ç«¯å£ã€ç”¨æˆ·å
2. ç‚¹å‡»ã€Œè¿æ¥ã€ï¼Œè¾“å…¥å¯†ç 
3. è¿æ¥æˆåŠŸåï¼Œç‚¹å‡»ã€Œéƒ¨ç½² Agentã€
4. éƒ¨ç½²å®Œæˆåï¼Œç‚¹å‡»ã€Œå¯åŠ¨ Agentã€

> Agent ä¼šè¢«ä¸Šä¼ è‡³é˜µåˆ—çš„ `/home/permitdir/observation_points` ç›®å½•

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. å°† observation_points ç›®å½•å¤åˆ¶åˆ°é˜µåˆ—
scp -r observation_points admin@é˜µåˆ—IP:/home/permitdir/

# 2. ç™»å½•é˜µåˆ—
ssh admin@é˜µåˆ—IP

# 3. åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p /var/log/observation-points

# 4. ç¼–è¾‘é…ç½®ï¼ˆæŒ‰éœ€ä¿®æ”¹ command å­—æ®µï¼‰
vi /home/permitdir/observation_points/config.json

# 5. å¯åŠ¨ Agent
cd /home/permitdir
python3 -m observation_points -c observation_points/config.json &
```

#### Agent é…ç½®è¦ç‚¹

ä»¥ä¸‹è§‚å¯Ÿç‚¹**éœ€è¦æ‰‹åŠ¨å¡«å†™å‘½ä»¤**ï¼ˆå› ä¸ºä¸åŒé˜µåˆ—çš„ç®¡ç†å‘½ä»¤ä¸åŒï¼‰ï¼š

| è§‚å¯Ÿç‚¹ | config.json ä¸­çš„å­—æ®µ | è¯´æ˜ |
|--------|---------------------|------|
| å¡ä»¶ä¿¡æ¯ (`card_info`) | `observers.card_info.command` | æŸ¥è¯¢æ‰€æœ‰å¡ä»¶ä¿¡æ¯çš„å‘½ä»¤ |
| æ§åˆ¶å™¨çŠ¶æ€ (`controller_state`) | `observers.controller_state.command` | æŸ¥è¯¢æ§åˆ¶å™¨çŠ¶æ€çš„å‘½ä»¤ |
| ç£ç›˜çŠ¶æ€ (`disk_state`) | `observers.disk_state.command` | æŸ¥è¯¢ç£ç›˜çŠ¶æ€çš„å‘½ä»¤ |

å…¶ä»–è§‚å¯Ÿç‚¹ï¼ˆå¦‚è¯¯ç ã€é“¾è·¯çŠ¶æ€ã€FECã€PCIe å¸¦å®½ç­‰ï¼‰ä½¿ç”¨**å†…ç½®é€šç”¨å‘½ä»¤**ï¼ˆethtoolã€sysfsã€lspciï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚

### 3.3 æœ¬åœ° PC éƒ¨ç½²ï¼ˆWeb å¹³å°ï¼‰

#### ä¸€é”®å¯åŠ¨

```bash
cd observation_web
bash start.sh
```

`start.sh` ä¼šè‡ªåŠ¨ï¼š
- æ£€æŸ¥ Python å’Œ Node.js ç‰ˆæœ¬
- å®‰è£… Python ä¾èµ–ï¼ˆ`pip install -r requirements.txt`ï¼‰
- å®‰è£…å‰ç«¯ä¾èµ–ï¼ˆ`npm install`ï¼‰
- å¯åŠ¨åç«¯æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ 9999ï¼‰
- å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆé»˜è®¤ç«¯å£ 5173ï¼‰

å¯åŠ¨æˆåŠŸåï¼Œæµè§ˆå™¨è®¿é—®ï¼š**http://localhost:5173**

#### æ‰‹åŠ¨å¯åŠ¨

```bash
# åç«¯
cd observation_web
pip install -r requirements.txt
python -m uvicorn backend.main:app --host 0.0.0.0 --port 9999

# å‰ç«¯ï¼ˆå¦å¼€ç»ˆç«¯ï¼‰
cd observation_web/frontend
npm install
npm run dev
```

#### ç”Ÿäº§æ¨¡å¼éƒ¨ç½²

```bash
# æ„å»ºå‰ç«¯é™æ€æ–‡ä»¶
cd observation_web/frontend
npm run build

# å¯åŠ¨åç«¯ï¼ˆå‰ç«¯ç”±åç«¯é™æ€æœåŠ¡æˆ– Nginx ä»£ç†ï¼‰
cd observation_web
python -m uvicorn backend.main:app --host 0.0.0.0 --port 9999
```

---

## 4. åŠŸèƒ½è¯¦è§£

### 4.1 ä»ªè¡¨ç›˜

**è·¯å¾„**ï¼š`/`ï¼ˆé¦–é¡µï¼‰

ä»ªè¡¨ç›˜æä¾›å…¨å±€æ¦‚è§ˆï¼ŒåŒ…å«ï¼š

- **ç»Ÿè®¡å¡ç‰‡**ï¼ˆå¯ç‚¹å‡»è·³è½¬ï¼‰ï¼š
  - æ€»é˜µåˆ—æ•° â†’ ç‚¹å‡»è·³è½¬åˆ°é˜µåˆ—ç®¡ç†
  - åœ¨çº¿é˜µåˆ— â†’ ç‚¹å‡»è·³è½¬åˆ°é˜µåˆ—ç®¡ç†
  - 24 å°æ—¶å‘Šè­¦æ•° â†’ ç‚¹å‡»è·³è½¬åˆ°å‘Šè­¦ä¸­å¿ƒ
  - é”™è¯¯å‘Šè­¦æ•° â†’ ç‚¹å‡»è·³è½¬åˆ°å‘Šè­¦ä¸­å¿ƒï¼Œå¹¶è‡ªåŠ¨ç­›é€‰é”™è¯¯çº§åˆ«
- **é˜µåˆ—å¥åº·çŸ©é˜µ**ï¼šå½©è‰²æ–¹å—æ˜¾ç¤ºå„é˜µåˆ—çŠ¶æ€ï¼ˆç»¿=æ­£å¸¸ï¼Œé»„=è­¦å‘Šï¼Œçº¢=é”™è¯¯ï¼Œç°=ç¦»çº¿ï¼‰
- **24 å°æ—¶å‘Šè­¦è¶‹åŠ¿**ï¼šæŠ˜çº¿å›¾å±•ç¤ºå‘Šè­¦æ•°é‡éšæ—¶é—´çš„å˜åŒ–
- **æœ€è¿‘å‘Šè­¦åˆ—è¡¨**ï¼šæ˜¾ç¤ºæœ€æ–°å‘Šè­¦ï¼Œç‚¹å‡»å¯æŸ¥çœ‹è¯¦æƒ…
- **æ´»è·ƒæµ‹è¯•ä»»åŠ¡æ¨ªå¹…**ï¼šå¦‚æœæœ‰æ­£åœ¨è¿›è¡Œçš„æµ‹è¯•ä»»åŠ¡ï¼Œåœ¨ç»Ÿè®¡å¡ç‰‡ä¸Šæ–¹æ˜¾ç¤ºä»»åŠ¡åç§°å’Œå·²è¿è¡Œæ—¶é—´

### 4.2 é˜µåˆ—ç®¡ç†

**è·¯å¾„**ï¼š`/arrays`

ç®¡ç†æ‰€æœ‰è¢«ç›‘æ§çš„å­˜å‚¨é˜µåˆ—ï¼š

- **æ·»åŠ é˜µåˆ—**ï¼šå¡«å†™åç§°ã€IP åœ°å€ã€SSH ç«¯å£ï¼ˆé»˜è®¤ 22ï¼‰ã€ç”¨æˆ·å
- **è¿æ¥é˜µåˆ—**ï¼šè¾“å…¥å¯†ç å SSH è¿æ¥ï¼Œå¯†ç ä¿å­˜åœ¨æœ¬åœ°ï¼Œæ–­å¼€åè‡ªåŠ¨é‡è¿ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒæ‰¹é‡è¿æ¥ã€æ–­å¼€ã€åˆ·æ–°ã€éƒ¨ç½² Agentã€å¯åŠ¨/åœæ­¢ Agent
- **é˜µåˆ—è¯¦æƒ…é¡µ**ï¼š
  - åŸºæœ¬ä¿¡æ¯ï¼ˆè¿æ¥çŠ¶æ€ã€Agent çŠ¶æ€ï¼‰
  - è§‚å¯Ÿç‚¹çŠ¶æ€ï¼ˆæŒ‰ç«¯å£çº§/å¡ä»¶çº§/ç³»ç»Ÿçº§åˆ†ç»„å±•ç¤ºï¼‰
  - æ€§èƒ½ç›‘æ§ï¼ˆCPU/å†…å­˜å®æ—¶æ›²çº¿ï¼‰
  - ç«¯å£æµé‡ç›‘æ§ï¼ˆTX/RX å¸¦å®½æ›²çº¿ï¼‰
  - äº‹ä»¶æ—¶é—´çº¿ï¼ˆè·¨è§‚å¯Ÿç‚¹æ—¶é—´è½´è§†å›¾ï¼‰
  - çŠ¶æ€å¿«ç…§ä¸å¯¹æ¯”
  - Agent æ§åˆ¶é¢æ¿ï¼ˆéƒ¨ç½²/å¯åŠ¨/åœæ­¢/é‡å¯/é…ç½®ä¿®æ”¹ï¼‰

**è¿æ¥ä¿æŒæœºåˆ¶**ï¼š
- SSH keepalive é—´éš”ï¼š30 ç§’
- ç©ºé—²è¿æ¥è‡ªåŠ¨æ¸…ç†ï¼š10 åˆ†é’Ÿæ— æ“ä½œ
- Agent å¥åº·æ£€æŸ¥ï¼šæ¯ 5 åˆ†é’Ÿæ£€æµ‹ Agent æ˜¯å¦ä»åœ¨è¿è¡Œ

### 4.3 å‘Šè­¦ä¸­å¿ƒ

**è·¯å¾„**ï¼š`/alerts`

é›†ä¸­ç®¡ç†æ‰€æœ‰é˜µåˆ—çš„å‘Šè­¦ä¿¡æ¯ï¼š

- **ç­›é€‰æ¡ä»¶**ï¼šå‘Šè­¦çº§åˆ«ã€è§‚å¯Ÿç‚¹ç±»å‹ã€æ—¶é—´èŒƒå›´ï¼ˆ1 å°æ—¶ / 6 å°æ—¶ / 24 å°æ—¶ / 7 å¤©ï¼‰
- **å¹³é“ºæ¨¡å¼**ï¼šä¼ ç»Ÿåˆ—è¡¨è§†å›¾ï¼ŒæŒ‰æ—¶é—´å€’åºæ˜¾ç¤ºæ¯æ¡å‘Šè­¦
- **èšåˆæ¨¡å¼**ï¼šï¼ˆé€šè¿‡å³ä¸Šè§’å¼€å…³åˆ‡æ¢ï¼‰
  - æ—¶é—´çª—å£èšåˆï¼šåŒä¸€é˜µåˆ—åŒä¸€è§‚å¯Ÿç‚¹åœ¨ 10 ç§’å†…è§¦å‘çš„å‘Šè­¦åˆå¹¶
  - æ ¹å› å…³è”ï¼šlink_down + FEC å˜åŒ– + é€Ÿç‡å˜åŒ– è‡ªåŠ¨èšåˆä¸ºã€Œç«¯å£é“¾è·¯äº‹ä»¶ã€
  - é£æš´æ£€æµ‹ï¼š60 ç§’å†…è¶…è¿‡ 20 æ¡å‘Šè­¦è§¦å‘ã€Œå‘Šè­¦é£æš´ã€æ‘˜è¦
- **å‘Šè­¦è¯¦æƒ…æŠ½å±‰**ï¼šç‚¹å‡»ä»»æ„å‘Šè­¦ï¼Œå³ä¾§å¼¹å‡ºè¯¦æƒ…é¢æ¿ï¼Œå±•ç¤ºï¼š
  - ä¸‰æ®µå¼å¡ç‰‡ï¼š**äº‹ä»¶**ï¼ˆå‘ç”Ÿäº†ä»€ä¹ˆï¼‰â†’ **å½±å“**ï¼ˆæœ‰ä»€ä¹ˆåæœï¼‰â†’ **å»ºè®®**ï¼ˆè¯¥æ€ä¹ˆå¤„ç†ï¼‰
  - ç»“æ„åŒ–ä¿¡æ¯ï¼ˆalarm_type ä¸“æœ‰ï¼‰
  - æ—¥å¿—æ¥æºè·¯å¾„
  - åŸå§‹æ¶ˆæ¯ï¼ˆå¯æŠ˜å ï¼‰
  - è¯¦ç»†æ•°æ® JSONï¼ˆå¯æŠ˜å ï¼‰
- **å¯¼å‡º**ï¼šæ”¯æŒå¯¼å‡ºä¸º CSV æ–‡ä»¶ï¼ˆæœ€å¤š 10000 æ¡ï¼‰

### 4.4 æµ‹è¯•ä»»åŠ¡ç®¡ç†

**è·¯å¾„**ï¼š`/test-tasks`

**è®¾è®¡ç›®çš„**ï¼šè®©ç³»ç»Ÿå…·å¤‡æµ‹è¯•ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›ï¼ŒåŒºåˆ†"æµ‹è¯•å¼•èµ·çš„é¢„æœŸå¼‚å¸¸"å’Œ"çœŸæ­£çš„é—®é¢˜"ã€‚

**ä½¿ç”¨æµç¨‹**ï¼š

1. **åˆ›å»ºä»»åŠ¡**ï¼šå¡«å†™ä»»åŠ¡åç§°ã€é€‰æ‹©æµ‹è¯•ç±»å‹ã€å…³è”é˜µåˆ—
2. **å¼€å§‹ä»»åŠ¡**ï¼šç‚¹å‡»ã€Œå¼€å§‹ã€ï¼Œç³»ç»Ÿè®°å½•å¼€å§‹æ—¶é—´
3. **æ‰§è¡Œæµ‹è¯•**ï¼šæ­£å¸¸æ‰§è¡Œæ‰‹å·¥/è‡ªåŠ¨åŒ–æµ‹è¯•æ“ä½œ
4. **ç»“æŸä»»åŠ¡**ï¼šç‚¹å‡»ã€Œç»“æŸã€ï¼Œç³»ç»Ÿè‡ªåŠ¨ï¼š
   - è®°å½•ç»“æŸæ—¶é—´
   - å°†æ—¶é—´çª—å£å†…çš„æ‰€æœ‰å‘Šè­¦è‡ªåŠ¨æ‰“ä¸Šè¯¥ä»»åŠ¡æ ‡ç­¾ï¼ˆ`task_id`ï¼‰
   - åœ¨äº‹ä»¶æ—¶é—´çº¿ä¸­ç”¨èƒŒæ™¯è‰²æ ‡è®°è¯¥ä»»åŠ¡çš„æ—¶é—´æ®µ

**æµ‹è¯•ç±»å‹é€‰é¡¹**ï¼š

| ç±»å‹ | è¯´æ˜ |
|------|------|
| æ­£å¸¸ä¸šåŠ¡ | å¸¸è§„è¯»å†™ã€ä¸šåŠ¡åŠŸèƒ½æµ‹è¯• |
| æ§åˆ¶å™¨ä¸‹ç”µ | æ§åˆ¶å™¨ä¸‹ç”µ/é‡å¯æµ‹è¯• |
| æ¥å£å¡ä¸‹ç”µ | æ¥å£å¡çƒ­æ’æ‹”ã€ä¸‹ç”µæµ‹è¯• |
| ç«¯å£å¼€å…³ | ç«¯å£ enable/disable æ“ä½œ |
| çº¿ç¼†æ‹”æ’ | ç‰©ç†çº¿ç¼†æ‹”æ’æµ‹è¯• |
| ç³»ç»Ÿæ•…éšœæ³¨å…¥ | æ³¨å…¥å„ç±»ç³»ç»Ÿçº§æ•…éšœ |
| æ§åˆ¶å™¨å‡çº§ | å›ºä»¶/ç³»ç»Ÿå‡çº§ï¼ˆå«ä¸‹ç”µæ­¥éª¤ï¼‰ |
| è‡ªå®šä¹‰ | å…¶ä»–ç±»å‹ |

**ä»»åŠ¡æ‘˜è¦**ï¼šä»»åŠ¡ç»“æŸåå¯æŸ¥çœ‹æ‘˜è¦æŠ¥å‘Šï¼ŒåŒ…å«ï¼š
- æŒç»­æ—¶é•¿
- å„çº§åˆ«å‘Šè­¦ç»Ÿè®¡
- å„è§‚å¯Ÿç‚¹å‘Šè­¦ç»Ÿè®¡
- å…³é”®äº‹ä»¶åˆ—è¡¨

### 4.5 äº‹ä»¶æ—¶é—´çº¿

**ä½ç½®**ï¼šé˜µåˆ—è¯¦æƒ…é¡µ â†’ äº‹ä»¶æ—¶é—´çº¿å¡ç‰‡

ä»¥æ•£ç‚¹å›¾å±•ç¤ºæ‰€æœ‰äº‹ä»¶çš„æ—¶é—´åˆ†å¸ƒï¼š

- **X è½´**ï¼šæ—¶é—´
- **Y è½´**ï¼šè§‚å¯Ÿç‚¹åˆ†ç±»ï¼ˆç«¯å£çº§ / å¡ä»¶çº§ / ç³»ç»Ÿçº§ï¼‰
- **é¢œè‰²**ï¼šçº¢ = é”™è¯¯/ä¸¥é‡ï¼Œé»„ = è­¦å‘Šï¼Œç° = ä¿¡æ¯
- **äº¤äº’**ï¼š
  - é¼ æ ‡æ‚¬åœæ˜¾ç¤ºäº‹ä»¶è¯¦æƒ…
  - æ”¯æŒé¼ æ ‡æ»šè½®ç¼©æ”¾æ—¶é—´è½´
  - æ”¯æŒæ‹–åŠ¨å¹³ç§»
- **æµ‹è¯•ä»»åŠ¡æ ‡è®°**ï¼šå¦‚æœ‰æ´»è·ƒæµ‹è¯•ä»»åŠ¡ï¼Œç”¨è“è‰²åŠé€æ˜èƒŒæ™¯æ ‡è®°ä»»åŠ¡æ—¶é—´æ®µ
- **ä¸‹æ–¹äº‹ä»¶è¡¨æ ¼**ï¼šåˆ—å‡ºæ‰€æœ‰äº‹ä»¶ï¼Œæ–¹ä¾¿å¿«é€Ÿæµè§ˆ

**æ—¶é—´èŒƒå›´é€‰æ‹©**ï¼šæœ€è¿‘ 1 å°æ—¶ / 6 å°æ—¶ / 24 å°æ—¶ / 3 å¤©

### 4.6 çŠ¶æ€å¿«ç…§ä¸å¯¹æ¯”

**ä½ç½®**ï¼šé˜µåˆ—è¯¦æƒ…é¡µ â†’ çŠ¶æ€å¿«ç…§ä¸å¯¹æ¯”å¡ç‰‡

**ä½¿ç”¨åœºæ™¯**ï¼šæµ‹è¯•å‰æ‹ä¸€ä¸ªå¿«ç…§ï¼Œæµ‹è¯•åå†æ‹ä¸€ä¸ªï¼Œå¯¹æ¯”ä¸¤ä¸ªå¿«ç…§å‘ç°çŠ¶æ€å·®å¼‚ã€‚

- **æ‹æ‘„å¿«ç…§**ï¼šæ•è·å½“å‰æ—¶åˆ»å„è§‚å¯Ÿç‚¹çš„æœ€æ–°å‘Šè­¦çŠ¶æ€
- **å¿«ç…§åˆ—è¡¨**ï¼šæ˜¾ç¤ºè¯¥é˜µåˆ—çš„æ‰€æœ‰å†å²å¿«ç…§
- **å¯¹æ¯”åŠŸèƒ½**ï¼šå‹¾é€‰ 2 ä¸ªå¿«ç…§ï¼Œç‚¹å‡»ã€Œå¯¹æ¯”ã€ï¼Œå±•ç¤ºå·®å¼‚è¡¨æ ¼ï¼š
  - ç»¿è‰² = æ–°å¢çš„è§‚å¯Ÿç‚¹
  - çº¢è‰² = ä¸¢å¤±çš„è§‚å¯Ÿç‚¹
  - é»„è‰² = çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„è§‚å¯Ÿç‚¹
  - æ˜¾ç¤ºå˜åŒ–å‰åçš„çº§åˆ«å’Œæ¶ˆæ¯

### 4.7 ç«¯å£æµé‡ç›‘æ§

**ä½ç½®**ï¼šé˜µåˆ—è¯¦æƒ…é¡µ â†’ ç«¯å£æµé‡ç›‘æ§å¡ç‰‡

å®æ—¶å±•ç¤ºç«¯å£ TX/RX å¸¦å®½æ›²çº¿ï¼š

- **ç«¯å£é€‰æ‹©**ï¼šä¸‹æ‹‰é€‰æ‹©è¦æŸ¥çœ‹çš„ç«¯å£
- **æ—¶é—´èŒƒå›´**ï¼šæœ€è¿‘ 5 åˆ†é’Ÿ / 10 åˆ†é’Ÿ / 30 åˆ†é’Ÿ / 1 å°æ—¶ / 2 å°æ—¶
- **æ›²çº¿å›¾**ï¼šåŒçº¿ï¼ˆTX å‘é€ / RX æ¥æ”¶ï¼‰ï¼Œé¼ æ ‡æ‚¬åœæ˜¾ç¤ºæ—¶é—´å’Œå¸¦å®½å€¼
- **å¸¦å®½å•ä½è‡ªåŠ¨é€‚é…**ï¼šb/s â†’ Kb/s â†’ Mb/s â†’ Gb/s
- **æ•°æ®åŒæ­¥**ï¼šç‚¹å‡»ã€ŒåŒæ­¥ã€æŒ‰é’®ä»é˜µåˆ—æ‹‰å–æœ€æ–°æµé‡æ•°æ®

**æ•°æ®ä¿ç•™ç­–ç•¥**ï¼š
- é˜µåˆ—ç«¯ï¼š`traffic.jsonl` æœ€å¤šä¿ç•™ 2 å°æ—¶æ•°æ®ï¼Œè¶…æ—¶è‡ªåŠ¨æ¸…ç†
- PC ç«¯æ•°æ®åº“ï¼šåŒæ­¥åä¹Ÿä¿ç•™ 2 å°æ—¶ï¼Œåå°è‡ªåŠ¨æ¸…ç†

### 4.8 æ€§èƒ½ç›‘æ§ï¼ˆCPU / å†…å­˜ï¼‰

**ä½ç½®**ï¼šé˜µåˆ—è¯¦æƒ…é¡µ â†’ æ€§èƒ½ç›‘æ§å¡ç‰‡ï¼ˆéœ€é˜µåˆ—å·²è¿æ¥ï¼‰

- å®æ—¶ CPU0 åˆ©ç”¨ç‡æ›²çº¿
- å®æ—¶å†…å­˜ä½¿ç”¨ç‡æ›²çº¿
- æ•°æ®é€šè¿‡ SSH å®šæœŸé‡‡é›†ï¼Œæ¯æ¬¡åˆ·æ–°æ—¶è·å–æœ€æ–°æ•°æ®ç‚¹

### 4.9 è‡ªå®šä¹‰æŸ¥è¯¢

**è·¯å¾„**ï¼š`/query`

åœ¨å·²è¿æ¥çš„é˜µåˆ—ä¸Šæ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤ï¼Œæ”¯æŒï¼š

- **å‘½ä»¤è¾“å…¥**ï¼šè¾“å…¥è¦åœ¨é˜µåˆ—ä¸Šæ‰§è¡Œçš„ shell å‘½ä»¤
- **è§„åˆ™åŒ¹é…**ï¼š
  - æ­£åˆ™åŒ¹é…ï¼šå¯¹è¾“å‡ºåšæ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥
  - å…³é”®å­—åŒ¹é…ï¼šæ£€æŸ¥è¾“å‡ºæ˜¯å¦åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²
  - å­—æ®µæå–ï¼šä»è¾“å‡ºä¸­æå–æŒ‡å®šå­—æ®µ
- **æŸ¥è¯¢æ¨¡æ¿**ï¼šä¿å­˜å¸¸ç”¨æŸ¥è¯¢ä¸ºæ¨¡æ¿ï¼Œä¸‹æ¬¡ä¸€é”®æ‰§è¡Œ
- **æ‰¹é‡æ‰§è¡Œ**ï¼šåŒæ—¶åœ¨å¤šä¸ªé˜µåˆ—ä¸Šæ‰§è¡ŒåŒä¸€æŸ¥è¯¢

### 4.10 å®šæ—¶ä»»åŠ¡

**è·¯å¾„**ï¼š`/tasks`

é…ç½®å‘¨æœŸæ€§è‡ªåŠ¨æ‰§è¡Œçš„æŸ¥è¯¢ä»»åŠ¡ï¼š

- å…³è”æŸ¥è¯¢æ¨¡æ¿
- Cron è¡¨è¾¾å¼é…ç½®è°ƒåº¦æ—¶é—´
- æŸ¥çœ‹å†å²æ‰§è¡Œç»“æœ
- æ”¯æŒæ‰‹åŠ¨ç«‹å³æ‰§è¡Œ

### 4.11 æ•°æ®ç®¡ç†ä¸å½’æ¡£

**è·¯å¾„**ï¼š`/data`

- **æ•°æ®å¯¼å…¥**ï¼šæ‰‹åŠ¨å¯¼å…¥å†å²å‘Šè­¦æ•°æ®
- **æ•°æ®å½’æ¡£**ï¼šé…ç½®è‡ªåŠ¨å½’æ¡£ç­–ç•¥ï¼ˆä¿ç•™å¤©æ•°ï¼Œé»˜è®¤ 30 å¤©ï¼‰
- **æ‰‹åŠ¨å½’æ¡£**ï¼šä¸€é”®æ¸…ç†è¿‡æœŸæ•°æ®
- **å½’æ¡£ç»Ÿè®¡**ï¼šæŸ¥çœ‹å·²å½’æ¡£æ•°æ®é‡

### 4.12 ç³»ç»Ÿå‘Šè­¦

**è·¯å¾„**ï¼š`/system-alerts`

æ˜¾ç¤ºç³»ç»Ÿè‡ªèº«çš„è¿è¡Œå¼‚å¸¸ï¼Œè€Œéé˜µåˆ—ç›‘æ§å‘Šè­¦ã€‚åŒ…æ‹¬ï¼š

- HTTP è¯·æ±‚å¼‚å¸¸ï¼ˆ500 é”™è¯¯ï¼‰
- æ…¢è¯·æ±‚ï¼ˆå“åº”è¶…è¿‡ 5 ç§’ï¼‰
- SSH è¿æ¥å¤±è´¥
- Agent å¼‚å¸¸åœæ­¢
- æ•°æ®åº“é”™è¯¯

**ç”¨é€”**ï¼šå½“å‘ç°åŠŸèƒ½ä¸æ­£å¸¸æ—¶ï¼Œä¼˜å…ˆæŸ¥çœ‹ç³»ç»Ÿå‘Šè­¦å®šä½é—®é¢˜ã€‚

### 4.13 å…³é”®äº‹ä»¶é€šçŸ¥

**å…¨å±€åŠŸèƒ½**ï¼Œæ— éœ€è¿›å…¥ç‰¹å®šé¡µé¢ï¼š

- **çº¢è‰²æ¨ªå¹…**ï¼šé¡µé¢é¡¶éƒ¨å›ºå®šæ˜¾ç¤ºï¼Œæœ‰æœªå¤„ç†çš„å…³é”®äº‹ä»¶æ—¶ä¸€ç›´å­˜åœ¨ï¼ˆå¸¦è„‰å†²åŠ¨ç”»ï¼‰
- **æ¡Œé¢é€šçŸ¥**ï¼šä½¿ç”¨æµè§ˆå™¨ Notification APIï¼Œå…³é”®äº‹ä»¶è§¦å‘æ—¶å¼¹å‡ºæ¡Œé¢é€šçŸ¥ï¼ˆéœ€ç”¨æˆ·æˆæƒï¼‰
- **æç¤ºéŸ³**ï¼šå¯åœ¨é¡µé¢å³ä¸Šè§’å¼€å…³ã€‚å¼€å¯åï¼Œå…³é”®äº‹ä»¶è§¦å‘æ—¶æ’­æ”¾çŸ­ä¿ƒåŒéŸ³æç¤º

**å…³é”®äº‹ä»¶å®šä¹‰**ï¼š
- è¿›ç¨‹å´©æºƒï¼ˆprocess_crashï¼‰
- IO è¶…æ—¶ï¼ˆio_timeoutï¼‰
- SIG å¼‚å¸¸ä¿¡å·ï¼ˆsig_monitorï¼‰
- æ§åˆ¶å™¨çŠ¶æ€å¼‚å¸¸ï¼ˆcontroller_stateï¼‰
- ç£ç›˜çŠ¶æ€å¼‚å¸¸ï¼ˆdisk_stateï¼‰
- æ‰€æœ‰ `critical` çº§åˆ«å‘Šè­¦

---

## 5. è§‚å¯Ÿç‚¹ï¼ˆObserverï¼‰å®Œæ•´åˆ—è¡¨

ç³»ç»Ÿå…±åŒ…å« **19 ä¸ªè§‚å¯Ÿç‚¹**ï¼Œåˆ†ä¸ºç«¯å£çº§ã€å¡ä»¶çº§ã€ç³»ç»Ÿçº§ä¸‰ç±»ã€‚

### 5.1 ç«¯å£çº§è§‚å¯Ÿç‚¹

| è§‚å¯Ÿç‚¹ | åç§° | ç›‘æ§å†…å®¹ | å‘½ä»¤æ¥æº | é»˜è®¤é—´éš” | å‘Šè­¦çº§åˆ« |
|--------|------|---------|---------|---------|---------|
| `error_code` | è¯¯ç ç›‘æµ‹ | ç«¯å£ CRC/FCS/å¸§é”™è¯¯è®¡æ•°å¢é‡ï¼ŒPCIe AER é”™è¯¯ | å†…ç½®ï¼ˆsysfs + ethtoolï¼‰ | 30s | WARNING |
| `link_status` | é“¾è·¯çŠ¶æ€ | ç«¯å£ carrier/operstate å˜åŒ–ï¼ˆUP/DOWNï¼‰ | å†…ç½®ï¼ˆsysfsï¼‰ | 5s | WARNING |
| `port_fec` | FEC æ¨¡å¼ | FEC ç¼–ç æ¨¡å¼æ˜¯å¦å‘ç”Ÿå˜åŒ– | å†…ç½®ï¼ˆethtool --show-fecï¼‰ | 60s | WARNING |
| `port_speed` | ç«¯å£é€Ÿç‡ | ç«¯å£é“¾æ¥é€Ÿç‡æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼ˆå¦‚ 25G â†’ 10Gï¼‰ | å†…ç½®ï¼ˆsysfs / ethtoolï¼‰ | 60s | WARNING |
| `port_traffic` | ç«¯å£æµé‡ | TX/RX å­—èŠ‚æ•°é‡‡é›†ï¼Œè®¡ç®—å¸¦å®½é€Ÿç‡ | å†…ç½®ï¼ˆsysfs statisticsï¼‰ | 30s | æ— å‘Šè­¦ï¼ˆä»…é‡‡é›†æ•°æ®ï¼‰ |

### 5.2 å¡ä»¶çº§è§‚å¯Ÿç‚¹

| è§‚å¯Ÿç‚¹ | åç§° | ç›‘æ§å†…å®¹ | å‘½ä»¤æ¥æº | é»˜è®¤é—´éš” | å‘Šè­¦çº§åˆ« |
|--------|------|---------|---------|---------|---------|
| `card_recovery` | å¡ä¿®å¤ | æ—¥å¿—ä¸­çš„ recover chiperr äº‹ä»¶ | å†…ç½®ï¼ˆè¯»å–æ—¥å¿—ï¼‰ | 30s | ERROR |
| `card_info` | å¡ä»¶ä¿¡æ¯ | RunningState / HealthState / Model çŠ¶æ€æ£€æŸ¥ | **éœ€ç”¨æˆ·æä¾›å‘½ä»¤** | 120s | ERROR / WARNING |
| `pcie_bandwidth` | PCIe å¸¦å®½ | LnkCap vs LnkSta å¯¹æ¯”ï¼Œæ£€æµ‹é™çº§ | å†…ç½®ï¼ˆlspci -vvvï¼‰ | 120s | WARNING |
| `controller_state` | æ§åˆ¶å™¨çŠ¶æ€ | æ§åˆ¶å™¨åœ¨çº¿/ç¦»çº¿/é™çº§çŠ¶æ€å˜åŒ– | **éœ€ç”¨æˆ·æä¾›å‘½ä»¤** | 60s | ERRORï¼ˆæŒç»­ï¼‰ |
| `disk_state` | ç£ç›˜çŠ¶æ€ | ç£ç›˜åœ¨çº¿/ç¦»çº¿/é‡å»º/æ•…éšœçŠ¶æ€å˜åŒ– | **éœ€ç”¨æˆ·æä¾›å‘½ä»¤** | 60s | ERROR / WARNINGï¼ˆæŒç»­ï¼‰ |

### 5.3 ç³»ç»Ÿçº§è§‚å¯Ÿç‚¹

| è§‚å¯Ÿç‚¹ | åç§° | ç›‘æ§å†…å®¹ | å‘½ä»¤æ¥æº | é»˜è®¤é—´éš” | å‘Šè­¦çº§åˆ« |
|--------|------|---------|---------|---------|---------|
| `alarm_type` | å‘Šè­¦äº‹ä»¶ | é˜µåˆ— alarm æ—¥å¿—ä¸­çš„ send/resume alarm äº‹ä»¶ | å†…ç½®ï¼ˆè¯»å–æ—¥å¿—ï¼‰ | 30s | WARNING / INFO |
| `memory_leak` | å†…å­˜ç›‘æµ‹ | å†…å­˜ä½¿ç”¨ç‡è¿ç»­ä¸Šå‡æ£€æµ‹ | å†…ç½®ï¼ˆfree -mï¼‰ | 5400sï¼ˆ1.5hï¼‰ | ERRORï¼ˆæŒç»­ï¼‰ |
| `cpu_usage` | CPU ç›‘æµ‹ | CPU0 åˆ©ç”¨ç‡è¶…é˜ˆå€¼æ£€æµ‹ | å†…ç½®ï¼ˆ/proc/statï¼‰ | 30s | ERRORï¼ˆæŒç»­ï¼‰ |
| `cmd_response` | å‘½ä»¤å“åº” | å‘½ä»¤æ‰§è¡Œè€—æ—¶æ˜¯å¦è¶…è¿‡é˜ˆå€¼ | ç”¨æˆ·é…ç½®å‘½ä»¤åˆ—è¡¨ | 60s | ERROR |
| `sig_monitor` | SIG ä¿¡å· | æ—¥å¿—ä¸­çš„å¼‚å¸¸ä¿¡å·äº‹ä»¶ | å†…ç½®ï¼ˆè¯»å–æ—¥å¿—ï¼‰ | 30s | ERROR |
| `sensitive_info` | æ•æ„Ÿä¿¡æ¯ | æ—¥å¿—ä¸­æ˜¯å¦æ³„éœ²å¯†ç /å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯ | å†…ç½®ï¼ˆè¯»å–æ—¥å¿—ï¼‰ | 30s | ERROR |
| `process_crash` | è¿›ç¨‹å´©æºƒ | segfault / core dump / OOM ç­‰å´©æºƒäº‹ä»¶ | å†…ç½®ï¼ˆæ—¥å¿— + dmesgï¼‰ | 30s | CRITICALï¼ˆæŒç»­ï¼‰ |
| `io_timeout` | IO è¶…æ—¶ | IO timeout / SCSI error ç­‰å­˜å‚¨ IO å¼‚å¸¸ | å†…ç½®ï¼ˆæ—¥å¿— + dmesgï¼‰ | 30s | ERROR / CRITICALï¼ˆæŒç»­ï¼‰ |
| `custom_commands` | è‡ªå®šä¹‰å‘½ä»¤ | ç”¨æˆ·è‡ªå®šä¹‰çš„ç›‘æµ‹å‘½ä»¤å’Œé¢„æœŸç»“æœ | ç”¨æˆ·é…ç½® | è‡ªå®šä¹‰ | WARNING |

> **"æŒç»­"æ ‡è®°**ï¼šè¯¥è§‚å¯Ÿç‚¹è§¦å‘å‘Šè­¦åï¼Œä¸å—å†·å´æ—¶é—´é™åˆ¶ï¼Œæ¯æ¬¡æ£€æŸ¥éƒ½ä¼šä¸ŠæŠ¥ï¼Œç›´åˆ°å¼‚å¸¸æ¢å¤ã€‚

### è§‚å¯Ÿç‚¹è¯¦ç»†è¯´æ˜

#### card_infoï¼ˆå¡ä»¶ä¿¡æ¯ï¼‰

**éœ€è¦ç”¨æˆ·å¡«å†™å‘½ä»¤**ã€‚åœ¨ `config.json` çš„ `observers.card_info.command` å­—æ®µä¸­å¡«å…¥æŸ¥è¯¢æ‰€æœ‰å¡ä»¶ä¿¡æ¯çš„å‘½ä»¤ã€‚

å‘½ä»¤å›æ˜¾æ ¼å¼è¦æ±‚ï¼š
```
No001  BoardId: 03024GRH
No001  Name: CX916
No001  Model: CX916
No001  RunningState: RUNNING
No001  HealthState: NORMAL
------------------
No002  BoardId: 03024GRJ
No002  Name: CX920
No002  RunningState: STOPPED
No002  HealthState: FAULT
```

è§£æè§„åˆ™ï¼š
- å¡ä»¶ä¹‹é—´ç”¨ `---` æ¨ªçº¿åˆ†éš”
- æ¯è¡Œæ ¼å¼ï¼š`Noç¼–å·  å­—æ®µå<åˆ†éš”ç¬¦>å€¼`
- åˆ†éš”ç¬¦æ”¯æŒï¼š`:`ã€`=`ã€`ğŸŸ°`ã€ç©ºæ ¼
- å‘Šè­¦æ¡ä»¶ï¼šRunningState â‰  RUNNING â†’ ERRORï¼ŒHealthState â‰  NORMAL â†’ ERRORï¼ŒModel ä¸ºç©º â†’ WARNING

#### controller_stateï¼ˆæ§åˆ¶å™¨çŠ¶æ€ï¼‰

**éœ€è¦ç”¨æˆ·å¡«å†™å‘½ä»¤**ã€‚å¡«å…¥æŸ¥è¯¢æ§åˆ¶å™¨çŠ¶æ€çš„å‘½ä»¤ï¼Œå›æ˜¾éœ€åŒ…å«æ§åˆ¶å™¨æ ‡è¯†å’ŒçŠ¶æ€å…³é”®å­—ã€‚

#### disk_stateï¼ˆç£ç›˜çŠ¶æ€ï¼‰

**éœ€è¦ç”¨æˆ·å¡«å†™å‘½ä»¤**ã€‚å¡«å…¥æŸ¥è¯¢ç£ç›˜çŠ¶æ€çš„å‘½ä»¤ï¼Œå›æ˜¾éœ€åŒ…å«ç£ç›˜æ ‡è¯†å’ŒçŠ¶æ€å…³é”®å­—ã€‚

#### process_crashï¼ˆè¿›ç¨‹å´©æºƒï¼‰

è‡ªåŠ¨æ‰«æä»¥ä¸‹å…³é”®å­—ï¼ˆæ— éœ€é…ç½®ï¼‰ï¼š
- `segfault at` â€” æ®µé”™è¯¯
- `core dumped` â€” æ ¸å¿ƒè½¬å‚¨
- `Out of memory...Killed process` â€” OOM æ€è¿›ç¨‹
- `general protection fault` â€” é€šç”¨ä¿æŠ¤é”™è¯¯
- `kernel BUG at` â€” å†…æ ¸ BUG
- `Oops:` â€” å†…æ ¸ Oops

#### io_timeoutï¼ˆIO è¶…æ—¶ï¼‰

è‡ªåŠ¨æ‰«æä»¥ä¸‹å…³é”®å­—ï¼ˆæ— éœ€é…ç½®ï¼‰ï¼š
- `I/O error` â€” IO é”™è¯¯
- `io timeout` â€” IO è¶…æ—¶
- `scsi error` â€” SCSI é”™è¯¯
- `Medium Error` â€” ä»‹è´¨é”™è¯¯
- `Hardware Error` â€” ç¡¬ä»¶é”™è¯¯
- `task abort` â€” ä»»åŠ¡ä¸­æ­¢
- `device offline` â€” è®¾å¤‡ç¦»çº¿
- `Buffer I/O error` â€” ç¼“å†²åŒº IO é”™è¯¯
- `EXT4-fs error` / `XFS error` â€” æ–‡ä»¶ç³»ç»Ÿé”™è¯¯

---

## 6. å‘Šè­¦ä½“ç³»

### 6.1 å‘Šè­¦çº§åˆ«

| çº§åˆ« | é¢œè‰² | å«ä¹‰ | å…¸å‹åœºæ™¯ |
|------|------|------|---------|
| INFOï¼ˆä¿¡æ¯ï¼‰ | ç°è‰² | æ­£å¸¸çŠ¶æ€è®°å½• | CPU æ­£å¸¸ã€å†å²å‘Šè­¦ä¸ŠæŠ¥ |
| WARNINGï¼ˆè­¦å‘Šï¼‰ | é»„è‰² | éœ€è¦å…³æ³¨ä½†ä¸ç´§æ€¥ | è¯¯ç å¢é•¿ã€FEC å˜åŒ–ã€ç«¯å£é€Ÿç‡å˜åŒ– |
| ERRORï¼ˆé”™è¯¯ï¼‰ | çº¢è‰² | éœ€è¦å¤„ç†çš„é—®é¢˜ | å¡ä»¶å¼‚å¸¸ã€å‘½ä»¤è¶…æ—¶ã€å†…å­˜æŒç»­å¢é•¿ |
| CRITICALï¼ˆä¸¥é‡ï¼‰ | æ·±çº¢è‰² | éœ€è¦ç«‹å³å¤„ç† | è¿›ç¨‹å´©æºƒã€å¤§é‡ IO è¶…æ—¶ |

### 6.2 å‘Šè­¦ä¸‰æ®µå¼å¯è¯»æ€§

æ¯æ¡å‘Šè­¦ç¿»è¯‘ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š

| éƒ¨åˆ† | å«ä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| **äº‹ä»¶** | å‘ç”Ÿäº†ä»€ä¹ˆ | eth2 é“¾è·¯æ–­å¼€ |
| **å½±å“** | æœ‰ä»€ä¹ˆåæœ | è¯¥ç«¯å£ä¸šåŠ¡ä¸­æ–­ï¼Œä¾èµ–è¯¥ç«¯å£çš„ IO å°†å—åˆ°å½±å“ |
| **å»ºè®®** | è¯¥æ€ä¹ˆå¤„ç† | æ£€æŸ¥çº¿ç¼†è¿æ¥ï¼Œç¡®è®¤æ˜¯å¦ä¸ºè®¡åˆ’æ“ä½œï¼ˆæ‹”çº¿/ä¸‹ç”µæµ‹è¯•ï¼‰ |

å‘Šè­¦è¯¦æƒ…é¢æ¿ä¸­ï¼Œä¸‰ä¸ªéƒ¨åˆ†ç”¨ä¸åŒé¢œè‰²æ ‡è®°ï¼š
- äº‹ä»¶ â†’ çº¢è‰²æ ‡ç­¾
- å½±å“ â†’ é»„è‰²æ ‡ç­¾
- å»ºè®® â†’ ç»¿è‰²æ ‡ç­¾

### 6.3 å‘Šè­¦èšåˆä¸é£æš´æŠ‘åˆ¶

#### æ—¶é—´çª—å£èšåˆ

åŒä¸€é˜µåˆ—ã€åŒä¸€è§‚å¯Ÿç‚¹åœ¨ **10 ç§’**å†…è§¦å‘çš„å¤šæ¡å‘Šè­¦ï¼Œè‡ªåŠ¨åˆå¹¶ä¸ºä¸€æ¡ï¼Œæ˜¾ç¤ºã€ŒXX ç§’å†…è¿ç»­è§¦å‘ N æ¬¡ã€ã€‚

#### æ ¹å› å…³è”

| è§¦å‘æ¡ä»¶ | èšåˆç»“æœ |
|---------|---------|
| link_status DOWN + port_fec å˜åŒ– + port_speed å˜åŒ– + error_code å¢é•¿ï¼ˆåŒä¸€ç«¯å£ï¼Œ30 ç§’å†…ï¼‰ | èšåˆä¸ºã€Œç«¯å£ ethX é“¾è·¯äº‹ä»¶ï¼ˆN é¡¹å…³è”å‘Šè­¦ï¼‰ã€ |
| card_info å¼‚å¸¸ + pcie_bandwidth é™çº§ + card_recoveryï¼ˆåŒä¸€å¡ä»¶ï¼Œ30 ç§’å†…ï¼‰ | èšåˆä¸ºã€Œå¡ä»¶ NoXXX å¼‚å¸¸äº‹ä»¶ï¼ˆN é¡¹å…³è”å‘Šè­¦ï¼‰ã€ |

#### é£æš´æ£€æµ‹

å½“åŒä¸€é˜µåˆ—åœ¨ **60 ç§’**å†…äº§ç”Ÿè¶…è¿‡ **20 æ¡**å‘Šè­¦æ—¶ï¼Œè§¦å‘é£æš´æ¨¡å¼ï¼š
- æ‰€æœ‰å‘Šè­¦åˆå¹¶ä¸ºä¸€æ¡é£æš´æ‘˜è¦
- å±•ç¤ºä¸ºé†’ç›®çš„é»„è‰²èšåˆå¡ç‰‡
- ç‚¹å‡»å¯å±•å¼€æŸ¥çœ‹æ‰€æœ‰å­å‘Šè­¦

---

## 7. é…ç½®å‚è€ƒ

### 7.1 Web ç«¯é…ç½®

é…ç½®æ–‡ä»¶ï¼š`observation_web/config.json`

```json
{
  "server": {
    "host": "0.0.0.0",        // ç›‘å¬åœ°å€
    "port": 9999,              // åç«¯ç«¯å£
    "debug": false,            // è°ƒè¯•æ¨¡å¼
    "cors_origins": ["*"]      // è·¨åŸŸå…è®¸æº
  },
  "ssh": {
    "default_port": 22,        // SSH é»˜è®¤ç«¯å£
    "timeout": 10,             // SSH è¿æ¥è¶…æ—¶ï¼ˆç§’ï¼‰
    "keepalive_interval": 30   // SSH keepalive é—´éš”ï¼ˆç§’ï¼‰
  },
  "database": {
    "path": "observation_web.db",  // æ•°æ®åº“æ–‡ä»¶è·¯å¾„
    "echo": false                   // æ˜¯å¦è¾“å‡º SQL æ—¥å¿—
  },
  "remote": {
    "agent_deploy_path": "/home/permitdir/observation_points",  // Agent éƒ¨ç½²è·¯å¾„
    "agent_log_path": "/var/log/observation-points/alerts.log",  // Agent å‘Šè­¦æ—¥å¿—è·¯å¾„
    "python_cmd": "python3"                                      // é˜µåˆ—ä¸Šçš„ Python å‘½ä»¤
  }
}
```

### 7.2 Agent ç«¯é…ç½®

é…ç½®æ–‡ä»¶ï¼šé˜µåˆ—ä¸Š `observation_points/config.json`

**å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼ˆå«æ‰€æœ‰è§‚å¯Ÿç‚¹ï¼Œæ³¨é‡Šè¯´æ˜ï¼‰ï¼š

```json
{
  "global": {
    "check_interval": 30,         // å…¨å±€æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰ï¼Œå„è§‚å¯Ÿç‚¹å¯ç‹¬ç«‹è®¾ç½®
    "max_memory_mb": 50,          // Agent æœ€å¤§å†…å­˜é™åˆ¶ï¼ˆMBï¼‰
    "subprocess_timeout": 10       // å­è¿›ç¨‹æ‰§è¡Œè¶…æ—¶ï¼ˆç§’ï¼‰
  },
  "reporter": {
    "output": "file",              // è¾“å‡ºæ–¹å¼ï¼šfile / syslog / both / console
    "file_path": "/var/log/observation-points/alerts.log",
    "cooldown_seconds": 300        // ç›¸åŒå‘Šè­¦å†·å´æ—¶é—´ï¼ˆç§’ï¼‰ï¼ŒæŒç»­å‘Šè­¦ä¸å—æ­¤é™åˆ¶
  },
  "observers": {
    "error_code": {
      "enabled": true,
      "interval": 30,
      "threshold": 0,              // è¯¯ç å¢é‡è¶…è¿‡æ­¤å€¼æ‰å‘Šè­¦ï¼Œ0=ä»»ä½•å¢é‡
      "ports": []                  // ç•™ç©º=è‡ªåŠ¨å‘ç°æ‰€æœ‰ç«¯å£
    },
    "link_status": {
      "enabled": true,
      "interval": 5                // é“¾è·¯çŠ¶æ€æ£€æµ‹é¢‘ç‡è¾ƒé«˜
    },
    "alarm_type": {
      "enabled": true,
      "interval": 30,
      "log_path": "/OSM/log/cur_debug/messages"
    },
    "cpu_usage": {
      "enabled": true,
      "interval": 30,
      "threshold_percent": 90,     // CPU åˆ©ç”¨ç‡é˜ˆå€¼
      "consecutive_threshold": 6   // è¿ç»­ 6 æ¬¡è¶…é˜ˆå€¼æ‰å‘Šè­¦ï¼ˆ= 3 åˆ†é’Ÿï¼‰
    },
    "memory_leak": {
      "enabled": true,
      "interval": 5400,            // 1.5 å°æ—¶æ£€æŸ¥ä¸€æ¬¡
      "consecutive_threshold": 8   // è¿ç»­ 8 æ¬¡å¢é•¿æ‰å‘Šè­¦ï¼ˆ= 12 å°æ—¶ï¼‰
    },
    "port_fec": {
      "enabled": true,
      "interval": 60
    },
    "port_speed": {
      "enabled": true,
      "interval": 60
    },
    "pcie_bandwidth": {
      "enabled": true,
      "interval": 120
    },
    "card_info": {
      "enabled": true,
      "interval": 120,
      "command": "",                // â† å¿…é¡»å¡«å†™ï¼ŒæŸ¥è¯¢å¡ä»¶ä¿¡æ¯çš„å‘½ä»¤
      "running_state_expect": "RUNNING",
      "health_state_expect": "NORMAL"
    },
    "port_traffic": {
      "enabled": true,
      "interval": 30,
      "retention_hours": 2         // æœ¬åœ°æµé‡æ•°æ®ä¿ç•™ 2 å°æ—¶
    },
    "controller_state": {
      "enabled": true,
      "interval": 60,
      "command": ""                // â† å¿…é¡»å¡«å†™ï¼ŒæŸ¥è¯¢æ§åˆ¶å™¨çŠ¶æ€çš„å‘½ä»¤
    },
    "disk_state": {
      "enabled": true,
      "interval": 60,
      "command": ""                // â† å¿…é¡»å¡«å†™ï¼ŒæŸ¥è¯¢ç£ç›˜çŠ¶æ€çš„å‘½ä»¤
    },
    "process_crash": {
      "enabled": true,
      "interval": 30               // æ— éœ€å¡«å†™å‘½ä»¤ï¼Œè‡ªåŠ¨æ‰«æç³»ç»Ÿæ—¥å¿—
    },
    "io_timeout": {
      "enabled": true,
      "interval": 30               // æ— éœ€å¡«å†™å‘½ä»¤ï¼Œè‡ªåŠ¨æ‰«æç³»ç»Ÿæ—¥å¿—
    },
    "sig_monitor": {
      "enabled": true,
      "interval": 30,
      "whitelist": [15, 61]        // å¿½ç•¥çš„ä¿¡å·ç¼–å·
    },
    "sensitive_info": {
      "enabled": true,
      "interval": 30
    },
    "cmd_response": {
      "enabled": true,
      "interval": 60,
      "timeout_seconds": 1,        // å‘½ä»¤æ‰§è¡Œè¶…è¿‡æ­¤æ—¶é—´å³å‘Šè­¦
      "commands": ["lscpu"]        // è¦ç›‘æµ‹æ‰§è¡Œæ—¶é—´çš„å‘½ä»¤åˆ—è¡¨
    }
  }
}
```

---

## 8. è§„æ ¼ä¸çº¦æŸ

### 8.1 é˜µåˆ—è§„æ¨¡

| è§„æ ¼é¡¹ | æ¨èå€¼ | æœ€å¤§å€¼ | è¯´æ˜ |
|--------|--------|--------|------|
| åŒæ—¶ç®¡ç†é˜µåˆ—æ•° | â‰¤ 20 å° | 50 å° | è¶…è¿‡ 20 å°å»ºè®®å¢å¤§ SSH çº¿ç¨‹æ± ï¼ˆå½“å‰ 20 çº¿ç¨‹ï¼‰ |
| åŒæ—¶åœ¨çº¿ï¼ˆå·²è¿æ¥ï¼‰é˜µåˆ—æ•° | â‰¤ 15 å° | 30 å° | æ¯å°é˜µåˆ—å ç”¨ 1 ä¸ª SSH é•¿è¿æ¥ |
| å•é˜µåˆ—å‘Šè­¦é‡ | â‰¤ 500 æ¡/å¤© | ä¸é™ | è¶…è¿‡æ­¤é‡å»ºè®®ç¼©çŸ­å½’æ¡£å‘¨æœŸ |
| æ€»å‘Šè­¦å­˜å‚¨é‡ | â‰¤ 10 ä¸‡æ¡ | çº¦ 50 ä¸‡æ¡ | SQLite åœ¨å¤§æ•°æ®é‡ä¸‹æŸ¥è¯¢å¯èƒ½å˜æ…¢ |

### 8.2 æ€§èƒ½å½±å“

| æ“ä½œ | è€—æ—¶é¢„æœŸ | å½±å“å› ç´  |
|------|---------|---------|
| åˆ·æ–°é˜µåˆ—çŠ¶æ€ | 2-10 ç§’ | SSH å»¶è¿Ÿã€å‘Šè­¦æ—¥å¿—å¤§å° |
| åŠ è½½å‘Šè­¦åˆ—è¡¨ | < 1 ç§’ | æ•°æ®é‡ã€ç­›é€‰æ¡ä»¶ |
| åŒæ­¥æµé‡æ•°æ® | 1-3 ç§’ | æµé‡æ•°æ®æ–‡ä»¶å¤§å° |
| æ‹æ‘„å¿«ç…§ | < 1 ç§’ | æ•°æ®åº“æŸ¥è¯¢ |
| éƒ¨ç½² Agent | 5-15 ç§’ | SSH ä¼ è¾“é€Ÿåº¦ |

### 8.3 è¶…è¿‡æ¨èè§„æ¨¡çš„å½±å“

å½“è¿æ¥é˜µåˆ—æ•°è¶…è¿‡ 20 å°æ—¶ï¼š
- **SSH çº¿ç¨‹æ± é¥±å’Œ**ï¼šå¹¶å‘æ“ä½œï¼ˆæ‰¹é‡åˆ·æ–°ã€æ‰¹é‡éƒ¨ç½²ï¼‰å¯èƒ½æ’é˜Ÿç­‰å¾…
- **åˆ·æ–°å»¶è¿Ÿå¢å¤§**ï¼šå•æ¬¡å…¨é‡åˆ·æ–°å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´
- **å‰ç«¯é¡µé¢ç¨æ…¢**ï¼šä»ªè¡¨ç›˜éœ€è¦åŠ è½½æ›´å¤šé˜µåˆ—çŠ¶æ€

**ç¼“è§£æªæ–½**ï¼š
- ä¸ç»å¸¸ä½¿ç”¨çš„é˜µåˆ—å¯æ–­å¼€è¿æ¥ï¼Œéœ€è¦æ—¶å†è¿æ¥
- ä½¿ç”¨ç­›é€‰æ¡ä»¶å‡å°‘å‘Šè­¦åŠ è½½é‡
- é€‚å½“å»¶é•¿éå…³é”®è§‚å¯Ÿç‚¹çš„æ£€æŸ¥é—´éš”

### 8.4 Agent èµ„æºå ç”¨

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| å†…å­˜å ç”¨ | < 50 MB |
| CPU å ç”¨ | < 2%ï¼ˆå•æ ¸ï¼‰ |
| ç£ç›˜å†™å…¥ | < 1 MB/å°æ—¶ï¼ˆå‘Šè­¦æ—¥å¿—ï¼‰ |
| ç½‘ç»œæµé‡ | ä»…æœ¬åœ°æ“ä½œï¼Œä¸ä¸»åŠ¨è”ç½‘ |

### 8.5 æ•°æ®ä¿ç•™ç­–ç•¥

| æ•°æ®ç±»å‹ | é»˜è®¤ä¿ç•™æ—¶é—´ | å¯é…ç½® |
|---------|-------------|--------|
| å‘Šè­¦è®°å½• | 30 å¤© | æ˜¯ï¼ˆæ•°æ®ç®¡ç† â†’ å½’æ¡£é…ç½®ï¼‰ |
| ç«¯å£æµé‡æ•°æ® | 2 å°æ—¶ | æ˜¯ï¼ˆAgent config.jsonï¼‰ |
| å¿«ç…§ | ä¸è‡ªåŠ¨åˆ é™¤ | æ‰‹åŠ¨ç®¡ç† |
| ç³»ç»Ÿå‘Šè­¦ | å†…å­˜ä¸­æœ€å¤š 500 æ¡ | å¦ |

### 8.6 çº¦æŸä¸é™åˆ¶

1. **ä¸æ”¯æŒ root ç›´æ¥ç™»å½•çš„é˜µåˆ—**ï¼šå¦‚æœé˜µåˆ—ç¦æ­¢ root SSH ç™»å½•ï¼Œä½¿ç”¨ admin ç­‰æ™®é€šç”¨æˆ·å³å¯ã€‚Agent å¯åŠ¨åå¯èƒ½éœ€è¦ sudo æƒé™è®¿é—®éƒ¨åˆ† sysfs æ–‡ä»¶
2. **å•æ•°æ®åº“é™åˆ¶**ï¼šä½¿ç”¨ SQLite å•æ–‡ä»¶æ•°æ®åº“ï¼Œä¸é€‚åˆå¤šäººåŒæ—¶å†™å…¥çš„åœºæ™¯ã€‚å¦‚æœéœ€è¦å¤šç”¨æˆ·éƒ¨ç½²ï¼Œå»ºè®®æ¯äººç‹¬ç«‹è¿è¡Œä¸€å¥—
3. **SSH å¯†ç ä¸åŠ å¯†å­˜å‚¨**ï¼šä¸ºäº†æ”¯æŒè‡ªåŠ¨é‡è¿ï¼Œå¯†ç ä¿å­˜åœ¨å†…å­˜ä¸­ï¼ŒæœåŠ¡é‡å¯åéœ€è¦é‡æ–°è¾“å…¥
4. **ä¸æ”¯æŒ HTTPS**ï¼šå½“å‰ä¸º HTTP æœåŠ¡ï¼Œä»…å»ºè®®åœ¨å†…ç½‘ç¯å¢ƒä½¿ç”¨
5. **éœ€è¦ç”¨æˆ·å¡«å†™çš„å‘½ä»¤**ï¼š`card_info`ã€`controller_state`ã€`disk_state` ä¸‰ä¸ªè§‚å¯Ÿç‚¹éœ€è¦æ ¹æ®é˜µåˆ—å‹å·æ‰‹åŠ¨å¡«å†™æŸ¥è¯¢å‘½ä»¤

---

## 9. å¸¸è§åœºæ™¯æ“ä½œæŒ‡å—

### åœºæ™¯ä¸€ï¼šæ­£å¸¸ä¸šåŠ¡æµ‹è¯•

1. ä»ªè¡¨ç›˜ç¡®è®¤é˜µåˆ—åœ¨çº¿ã€Agent è¿è¡Œä¸­
2. åˆ›å»ºæµ‹è¯•ä»»åŠ¡ï¼šç±»å‹é€‰ã€Œæ­£å¸¸ä¸šåŠ¡ã€ï¼Œå…³è”ç›®æ ‡é˜µåˆ—
3. ç‚¹å‡»ã€Œå¼€å§‹ã€
4. æ‰§è¡Œæµ‹è¯•æ“ä½œ
5. æµ‹è¯•å®Œæˆåç‚¹å‡»ã€Œç»“æŸã€
6. æŸ¥çœ‹ä»»åŠ¡æ‘˜è¦ï¼Œå…³æ³¨æ˜¯å¦æœ‰éé¢„æœŸå‘Šè­¦

### åœºæ™¯äºŒï¼šæ§åˆ¶å™¨ä¸‹ç”µæµ‹è¯•

1. æµ‹è¯•å‰ï¼šåœ¨é˜µåˆ—è¯¦æƒ…é¡µç‚¹å‡»ã€Œæ‹æ‘„å¿«ç…§ã€ä¿å­˜åŸºçº¿çŠ¶æ€
2. åˆ›å»ºæµ‹è¯•ä»»åŠ¡ï¼šç±»å‹é€‰ã€Œæ§åˆ¶å™¨ä¸‹ç”µã€
3. å¼€å§‹ä»»åŠ¡ â†’ æ‰§è¡Œä¸‹ç”µæ“ä½œ
4. è§‚å¯Ÿï¼š
   - äº‹ä»¶æ—¶é—´çº¿ï¼šçœ‹åˆ° controller_state å˜ä¸º offline
   - å¯èƒ½è§¦å‘çš„å…³è”å‘Šè­¦ï¼šlink_status DOWNã€error_code å¢é•¿
   - å‘Šè­¦èšåˆä¼šè‡ªåŠ¨å½’ç±»
5. æ§åˆ¶å™¨ä¸Šç”µæ¢å¤åï¼š
   - è§‚å¯Ÿ controller_state æ¢å¤ä¸º online
   - å†æ‹ä¸€ä¸ªå¿«ç…§
   - å¯¹æ¯”ä¸¤ä¸ªå¿«ç…§ï¼Œç¡®è®¤æ‰€æœ‰çŠ¶æ€æ¢å¤
6. ç»“æŸä»»åŠ¡ï¼ŒæŸ¥çœ‹æ‘˜è¦

### åœºæ™¯ä¸‰ï¼šçº¿ç¼†æ‹”æ’æµ‹è¯•

1. åˆ›å»ºæµ‹è¯•ä»»åŠ¡ï¼šç±»å‹é€‰ã€Œçº¿ç¼†æ‹”æ’ã€
2. å¼€å§‹ä»»åŠ¡
3. æ‹”çº¿åé¢„æœŸå‘Šè­¦ï¼ˆèšåˆä¸ºä¸€æ¡ï¼‰ï¼š
   - link_statusï¼šethX DOWN
   - port_fecï¼šFEC æ¨¡å¼å˜åŒ–
   - port_speedï¼šé€Ÿç‡å˜åŒ–
   - error_codeï¼šè¯¯ç å¢é•¿
4. æ’çº¿åè§‚å¯Ÿæ¢å¤
5. å…³æ³¨ï¼šæ˜¯å¦æœ‰éé¢„æœŸçš„ process_crash æˆ– io_timeout

### åœºæ™¯å››ï¼šé•¿æ—¶é—´ç¨³å®šæ€§æµ‹è¯•

1. åˆ›å»ºæµ‹è¯•ä»»åŠ¡ï¼šç±»å‹é€‰ã€Œæ­£å¸¸ä¸šåŠ¡ã€ï¼Œå¤‡æ³¨æµ‹è¯•æ—¶é•¿
2. å¼€å§‹ä»»åŠ¡
3. å®šæœŸæ£€æŸ¥ä»ªè¡¨ç›˜å’Œå‘Šè­¦ä¸­å¿ƒ
4. é‡ç‚¹å…³æ³¨ï¼š
   - memory_leakï¼šå†…å­˜æ˜¯å¦æŒç»­å¢é•¿
   - cpu_usageï¼šCPU æ˜¯å¦æŒç»­é«˜è´Ÿè½½
   - process_crashï¼šæ˜¯å¦æœ‰è¿›ç¨‹å´©æºƒ
   - io_timeoutï¼šæ˜¯å¦æœ‰ IO è¶…æ—¶
5. æµ‹è¯•ç»“æŸåæŸ¥çœ‹ä»»åŠ¡æ‘˜è¦

### åœºæ™¯äº”ï¼šå‘ç°é—®é¢˜åçš„æ’æŸ¥æµç¨‹

1. åœ¨å‘Šè­¦ä¸­å¿ƒçœ‹åˆ°çº¢è‰²å‘Šè­¦
2. ç‚¹å‡»å‘Šè­¦æŸ¥çœ‹è¯¦æƒ…ï¼š
   - **äº‹ä»¶**ï¼šç¡®è®¤å‘ç”Ÿäº†ä»€ä¹ˆ
   - **å½±å“**ï¼šäº†è§£å½±å“èŒƒå›´
   - **å»ºè®®**ï¼šæŒ‰ç…§å»ºè®®æ“ä½œ
3. å¦‚æœæœ‰å…³è”å‘Šè­¦ï¼Œåˆ‡æ¢åˆ°èšåˆæ¨¡å¼æŸ¥çœ‹æ ¹å› 
4. åœ¨äº‹ä»¶æ—¶é—´çº¿ä¸­æŸ¥çœ‹äº‹ä»¶å‰åè¿˜å‘ç”Ÿäº†ä»€ä¹ˆ
5. å¦‚æœéœ€è¦å¯¹æ¯”çŠ¶æ€å˜åŒ–ï¼Œä½¿ç”¨å¿«ç…§å¯¹æ¯”
6. å¦‚æœæ˜¯ç³»ç»Ÿè‡ªèº«é—®é¢˜ï¼ŒæŸ¥çœ‹ç³»ç»Ÿå‘Šè­¦é¡µé¢

---

## 10. æ•…éšœæ’æŸ¥

### 10.1 Web å¹³å°æ— æ³•å¯åŠ¨

| é—®é¢˜ | æ’æŸ¥æ–¹æ³• |
|------|---------|
| ç«¯å£è¢«å ç”¨ | `lsof -i :9999` æˆ– `netstat -tlnp \| grep 9999`ï¼Œç»ˆæ­¢å ç”¨è¿›ç¨‹æˆ–ä¿®æ”¹ç«¯å£ |
| Python ä¾èµ–ç¼ºå¤± | `pip install -r requirements.txt` |
| Node.js ä¾èµ–ç¼ºå¤± | `cd frontend && npm install` |
| æ•°æ®åº“æŸå | åˆ é™¤ `observation_web.db` æ–‡ä»¶ï¼Œé‡å¯åè‡ªåŠ¨é‡å»ºï¼ˆæ•°æ®å°†ä¸¢å¤±ï¼‰ |

### 10.2 æ— æ³•è¿æ¥é˜µåˆ—

| é—®é¢˜ | æ’æŸ¥æ–¹æ³• |
|------|---------|
| SSH è¶…æ—¶ | ç¡®è®¤ PC èƒ½ ping é€šé˜µåˆ— IP |
| è®¤è¯å¤±è´¥ | æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡® |
| è¿æ¥é¢‘ç¹æ–­å¼€ | æ£€æŸ¥ç½‘ç»œç¨³å®šæ€§ï¼Œç¡®è®¤é˜²ç«å¢™æœªæ‹¦æˆª SSH |

### 10.3 Agent æ— æ³•å¯åŠ¨

| é—®é¢˜ | æ’æŸ¥æ–¹æ³• |
|------|---------|
| Python ç‰ˆæœ¬ä¸å¤Ÿ | `python3 --version`ï¼Œéœ€ 3.6+ |
| æƒé™ä¸è¶³ | ç¡®è®¤æœ‰ /var/log/observation-points ç›®å½•çš„å†™æƒé™ |
| config.json æ ¼å¼é”™è¯¯ | ç”¨ `python3 -m json.tool config.json` æ£€æŸ¥ JSON æ ¼å¼ |

### 10.4 å‘Šè­¦ä¸åŒæ­¥

| é—®é¢˜ | æ’æŸ¥æ–¹æ³• |
|------|---------|
| é˜µåˆ—ä¸Š alerts.log ä¸ºç©º | ç¡®è®¤ Agent æ­£åœ¨è¿è¡Œï¼ˆ`ps aux \| grep observation`ï¼‰ |
| PC ç«¯çœ‹ä¸åˆ°å‘Šè­¦ | ç‚¹å‡»é˜µåˆ—è¯¦æƒ…çš„ã€Œåˆ·æ–°ã€æŒ‰é’®æ‰‹åŠ¨åŒæ­¥ |
| å‘Šè­¦å»¶è¿Ÿ | æ£€æŸ¥ SSH è¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œç½‘ç»œå»¶è¿Ÿæ˜¯å¦è¿‡å¤§ |

### 10.5 é¡µé¢å¡é¡¿

| é—®é¢˜ | æ’æŸ¥æ–¹æ³• |
|------|---------|
| å‘Šè­¦æ•°æ®é‡è¿‡å¤§ | ç¼©çŸ­ç­›é€‰æ—¶é—´èŒƒå›´ï¼Œæ‰§è¡Œæ•°æ®å½’æ¡£æ¸…ç† |
| é˜µåˆ—æ•°è¿‡å¤š | æ–­å¼€ä¸éœ€è¦å®æ—¶ç›‘æ§çš„é˜µåˆ— |
| æµè§ˆå™¨å†…å­˜ä¸è¶³ | åˆ·æ–°é¡µé¢ï¼Œå…³é—­å…¶ä»–æ ‡ç­¾é¡µ |

---

## 11. æœ¯è¯­è¡¨

| æœ¯è¯­ | è¯´æ˜ |
|------|------|
| **Agent** | è¿è¡Œåœ¨å­˜å‚¨é˜µåˆ—ä¸Šçš„ç›‘æ§è¿›ç¨‹ï¼ˆobservation_pointsï¼‰ï¼Œè´Ÿè´£é‡‡é›†æ•°æ®å’Œç”Ÿæˆå‘Šè­¦ |
| **è§‚å¯Ÿç‚¹ï¼ˆObserverï¼‰** | ä¸€ä¸ªç‹¬ç«‹çš„ç›‘æ§æ£€æŸ¥é¡¹ï¼Œå¦‚è¯¯ç ç›‘æµ‹ã€é“¾è·¯çŠ¶æ€ç­‰ |
| **å‘Šè­¦ï¼ˆAlertï¼‰** | è§‚å¯Ÿç‚¹æ£€æŸ¥å‘ç°å¼‚å¸¸æ—¶ç”Ÿæˆçš„é€šçŸ¥ |
| **sticky å‘Šè­¦** | æŒç»­å‘Šè­¦ï¼Œè§¦å‘åæ¯æ¬¡æ£€æŸ¥éƒ½ä¸ŠæŠ¥ï¼Œä¸å—å†·å´æ—¶é—´é™åˆ¶ï¼Œç›´åˆ°å¼‚å¸¸æ¢å¤ |
| **å†·å´æ—¶é—´ï¼ˆCooldownï¼‰** | åŒä¸€å‘Šè­¦çš„æŠ‘åˆ¶æ—¶é—´ï¼Œé»˜è®¤ 5 åˆ†é’Ÿå†…ä¸é‡å¤ä¸ŠæŠ¥ï¼ˆsticky å‘Šè­¦é™¤å¤–ï¼‰ |
| **å‘Šè­¦é£æš´** | çŸ­æ—¶é—´å†…å¤§é‡å‘Šè­¦æ¶Œå…¥çš„æƒ…å†µï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆå¹¶ä¸ºæ‘˜è¦ |
| **æµ‹è¯•ä»»åŠ¡** | ä¸€æ¬¡æµ‹è¯•æ´»åŠ¨çš„æ—¶é—´çª—å£ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†è¯¥æ—¶é—´æ®µå†…çš„å‘Šè­¦ä¸ä»»åŠ¡å…³è” |
| **å¿«ç…§** | æŸä¸€æ—¶åˆ»é˜µåˆ—æ‰€æœ‰è§‚å¯Ÿç‚¹çŠ¶æ€çš„å®Œæ•´è®°å½•ï¼Œç”¨äºå‰åå¯¹æ¯” |
| **SSH Pool** | SSH è¿æ¥æ± ï¼Œç®¡ç†å’Œå¤ç”¨ä¸å„é˜µåˆ—çš„ SSH è¿æ¥ |
| **FEC** | Forward Error Correctionï¼Œå‰å‘çº é”™ç¼–ç ï¼Œç”¨äºç½‘ç»œç«¯å£æ•°æ®ä¼ è¾“çº é”™ |
| **PCIe** | Peripheral Component Interconnect Expressï¼Œé«˜é€Ÿä¸²è¡Œè®¡ç®—æœºæ‰©å±•æ€»çº¿æ ‡å‡† |
| **LnkCap / LnkSta** | PCIe é“¾è·¯èƒ½åŠ› / é“¾è·¯çŠ¶æ€ï¼Œç”¨äºæ£€æµ‹ PCIe é™çº§ |
| **OOM** | Out of Memoryï¼Œæ“ä½œç³»ç»Ÿå› å†…å­˜ä¸è¶³è€Œæ€æ­»è¿›ç¨‹ |
| **SCSI Error** | Small Computer System Interface é”™è¯¯ï¼Œå­˜å‚¨ IO é€šé“å¼‚å¸¸ |
| **sysfs** | Linux è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆ/sysï¼‰ï¼Œæä¾›ç¡¬ä»¶ä¿¡æ¯è¯»å–æ¥å£ |
| **ethtool** | Linux ç½‘ç»œé©±åŠ¨å’Œç¡¬ä»¶è®¾ç½®æŸ¥è¯¢å·¥å…· |
| **lspci** | Linux PCI è®¾å¤‡åˆ—è¡¨æŸ¥è¯¢å·¥å…· |

---

## é™„å½•ï¼šå¿«é€Ÿå‚è€ƒå¡

### é»˜è®¤ç«¯å£

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| Web åç«¯ API | 9999 | FastAPI æœåŠ¡ |
| å‰ç«¯å¼€å‘æœåŠ¡å™¨ | 5173 | Vite å¼€å‘æ¨¡å¼ |
| SSH è¿æ¥ | 22 | è¿æ¥å­˜å‚¨é˜µåˆ— |
| WebSocket | 9999 | ä¸åç«¯åŒç«¯å£ï¼Œè·¯å¾„ /ws/alerts |

### é»˜è®¤æ–‡ä»¶è·¯å¾„

| æ–‡ä»¶ | ä½ç½® | è¯´æ˜ |
|------|------|------|
| Web é…ç½® | `observation_web/config.json` | Web å¹³å°é…ç½® |
| Agent é…ç½® | é˜µåˆ—ä¸Š `config.json` | Agent ç«¯é…ç½® |
| å‘Šè­¦æ—¥å¿— | é˜µåˆ—ä¸Š `/var/log/observation-points/alerts.log` | Agent è¾“å‡ºçš„å‘Šè­¦ |
| æµé‡æ•°æ® | é˜µåˆ—ä¸Š `/var/log/observation-points/traffic.jsonl` | ç«¯å£æµé‡é‡‡é›† |
| æ•°æ®åº“ | `observation_web/observation_web.db` | SQLite æ•°æ®åº“ |

### å¿«æ·é”® / å¿«æ·æ“ä½œ

| æ“ä½œ | æ–¹æ³• |
|------|------|
| å¿«é€ŸæŸ¥çœ‹é”™è¯¯å‘Šè­¦ | ä»ªè¡¨ç›˜ç‚¹å‡»ã€Œé”™è¯¯å‘Šè­¦ã€æ•°å­— |
| å¯¹æ¯”æµ‹è¯•å‰åçŠ¶æ€ | é˜µåˆ—è¯¦æƒ… â†’ æµ‹è¯•å‰æ‹å¿«ç…§ â†’ æµ‹è¯•åæ‹å¿«ç…§ â†’ å¯¹æ¯” |
| æŸ¥çœ‹å‘Šè­¦æ ¹å›  | å‘Šè­¦ä¸­å¿ƒ â†’ åˆ‡æ¢åˆ°ã€Œèšåˆã€æ¨¡å¼ |
| æŸ¥çœ‹äº‹ä»¶å…ˆåå…³ç³» | é˜µåˆ—è¯¦æƒ… â†’ äº‹ä»¶æ—¶é—´çº¿ |
| åˆ›å»ºæµ‹è¯•ä¸Šä¸‹æ–‡ | ä¾§æ ã€Œæµ‹è¯•ä»»åŠ¡ã€â†’ åˆ›å»º â†’ å¼€å§‹ |
